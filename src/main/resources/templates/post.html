<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml" data-theme="light">
<meta charset="UTF-8">
<head>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <title th:text="'BookMarket - ' + ${post?.title} ?: '게시글'">BookMarket - 게시글</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .content-section {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }
        .post-content {
            line-height: 1.8;
            white-space: pre-wrap;
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Navigation from fragments -->
    <div th:replace="fragments/header :: header"></div>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <!-- Breadcrumbs -->
        <div class="breadcrumbs text-sm text-white/80 mb-6">
            <ul>
                <li><a href="/" class="hover:text-white"><i class="fas fa-home mr-1"></i>홈</a></li>
                <li><a href="/post/list" class="hover:text-white"><i class="fas fa-list mr-1"></i>게시판</a></li>
                <li th:text="${post?.title} ?: '게시글'">게시글</li>
            </ul>
        </div>

        <!-- Post Content -->
        <div class="max-w-4xl mx-auto" th:if="${post != null}">
            <!-- Post Header -->
            <div class="card bg-base-100 shadow-2xl content-section mb-6">
                <div class="card-body p-8">
                    <!-- Category Badge -->
                    <div class="flex items-center justify-between mb-4">
                        <div class="badge badge-outline badge-lg" 
                             th:classappend="${post.category.name() == 'REVIEW'} ? 'badge-primary' : (${post.category.name() == 'CHAT'} ? 'badge-secondary' : 'badge-accent')"
                             th:text="${post.category.displayName}">카테고리</div>
                        
                        <!-- Post Stats -->
                        <div class="flex items-center gap-4 text-sm text-base-content/60">
                            <div class="flex items-center">
                                <i class="fas fa-eye mr-1"></i>
                                <span th:text="${post.viewCount}">0</span>
                            </div>
                            <div class="flex items-center">
                                <i class="fas fa-heart mr-1 text-red-500"></i>
                                <span th:text="${post.likeCount}">0</span>
                            </div>
                            <div class="flex items-center" th:if="${post.createdAt != null}">
                                <i class="fas fa-clock mr-1"></i>
                                <span th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}">2024-12-25 12:34</span>
                            </div>
                        </div>
                    </div>

                    <!-- Title -->
                    <h1 class="text-4xl font-bold mb-4 flex items-center">
                        <!-- Category Icon -->
                        <i th:class="${post.category.name() == 'REVIEW'} ? 'fas fa-star text-yellow-500 mr-3' : 
                                    (${post.category.name() == 'DISCUSSION'} ? 'fas fa-comments text-blue-500 mr-3' : 
                                    (${post.category.name() == 'RECOMMENDATION'} ? 'fas fa-thumbs-up text-green-500 mr-3' : 
                                    (${post.category.name() == 'QUESTION'} ? 'fas fa-question-circle text-purple-500 mr-3' : 
                                    'fas fa-file-alt text-gray-500 mr-3')))"></i>
                        
                        <span th:text="${post.title}">게시글 제목</span>
                        
                        <!-- Spoiler Alert Badge -->
                        <div th:if="${post.spoilerAlert}" class="badge badge-warning ml-3" title="스포일러 주의">
                            <i class="fas fa-exclamation-triangle mr-1"></i>스포일러 주의
                        </div>
                    </h1>

                    <!-- Author Info -->
                    <div class="flex items-center justify-between mb-6 p-4 bg-base-200/50 rounded-lg">
                        <div class="flex items-center">
                            <div class="avatar mr-3">
                                <div class="w-12 rounded-full bg-gradient-to-r from-purple-600 to-blue-600 flex items-center justify-center">
                                    <i class="fas fa-user text-white"></i>
                                </div>
                            </div>
                            <div>
                                <div class="font-semibold text-lg" th:text="${post.user?.nickname} ?: '익명'">작성자</div>
                                <div class="text-sm text-base-content/60">작성자</div>
                            </div>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="flex gap-2">
                            <button class="btn btn-sm btn-outline">
                                <i class="fas fa-heart mr-1"></i>
                                추천 <span th:text="${post.likeCount}">0</span>
                            </button>
                            <button class="btn btn-sm btn-outline">
                                <i class="fas fa-share mr-1"></i>
                                공유
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Book Information (if exists) -->
            <div th:if="${post.bookTitle != null}" class="card bg-base-100 shadow-2xl content-section mb-6">
                <div class="card-body p-8">
                    <h3 class="text-2xl font-bold mb-4 flex items-center">
                        <i class="fas fa-book mr-3 text-blue-600"></i>
                        도서 정보
                    </h3>
                    
                    <div class="grid md:grid-cols-2 gap-6">
                        <!-- Book Details -->
                        <div class="space-y-4">
                            <div class="flex items-center">
                                <i class="fas fa-book-open mr-3 text-blue-600 w-5"></i>
                                <div>
                                    <div class="text-sm text-base-content/60">제목</div>
                                    <div class="font-semibold text-lg" th:text="${post.bookTitle}">책 제목</div>
                                </div>
                            </div>
                            
                            <div th:if="${post.author}" class="flex items-center">
                                <i class="fas fa-user-edit mr-3 text-blue-600 w-5"></i>
                                <div>
                                    <div class="text-sm text-base-content/60">저자</div>
                                    <div class="font-semibold" th:text="${post.author}">저자명</div>
                                </div>
                            </div>
                            
                            <div th:if="${post.genre}" class="flex items-center">
                                <i class="fas fa-list mr-3 text-blue-600 w-5"></i>
                                <div>
                                    <div class="text-sm text-base-content/60">장르</div>
                                    <div class="badge badge-ghost" th:text="${post.genre.displayName}">장르</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Rating (if review) -->
                        <div th:if="${post.rating != null}" class="flex flex-col items-center justify-center">
                            <div class="text-sm text-base-content/60 mb-2">평점</div>
                            <div class="text-3xl mb-2">
                                <span th:each="star : ${#numbers.sequence(1, post.rating)}" class="text-yellow-500">⭐</span>
                                <span th:each="empty : ${#numbers.sequence(post.rating + 1, 5)}" class="text-gray-300">⭐</span>
                            </div>
                            <div class="text-lg font-bold" th:text="${post.rating} + '/5'">5/5</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Post Content -->
            <div class="card bg-base-100 shadow-2xl content-section mb-6">
                <div class="card-body p-8">
                    <h3 class="text-2xl font-bold mb-6 flex items-center">
                        <i class="fas fa-align-left mr-3 text-primary"></i>
                        본문
                    </h3>
                    
                    <!-- Spoiler Warning -->
                    <div th:if="${post.spoilerAlert}" class="alert alert-warning mb-6">
                        <div>
                            <i class="fas fa-exclamation-triangle"></i>
                            <span><strong>스포일러 주의!</strong> 이 글에는 책의 내용을 누설하는 부분이 포함되어 있을 수 있습니다.</span>
                        </div>
                    </div>
                    
                    <!-- Content -->
                    <div class="post-content text-lg leading-relaxed" th:text="${post.content}">
                        게시글 내용이 여기에 표시됩니다...
                    </div>
                </div>
            </div>

            <!-- Comments Section -->
            <div class="card bg-base-100 shadow-2xl content-section">
                <div class="card-body p-8">
                    <h3 class="text-2xl font-bold mb-6 flex items-center">
                        <i class="fas fa-comments mr-3 text-secondary"></i>
                        댓글 <span class="badge badge-secondary ml-2">0</span>
                    </h3>
                    
                    <!-- Comment Form -->
                    <div class="mb-8">
                        <div class="form-control">
                            <textarea class="textarea textarea-bordered h-24" placeholder="댓글을 입력하세요..."></textarea>
                        </div>
                        <div class="flex justify-end mt-3">
                            <button class="btn btn-primary">
                                <i class="fas fa-paper-plane mr-2"></i>
                                댓글 작성
                            </button>
                        </div>
                    </div>
                    
                    <!-- Comments List -->
                    <div class="text-center py-12 text-base-content/60">
                        <i class="fas fa-comment-slash text-4xl mb-4"></i>
                        <p class="text-lg">아직 댓글이 없습니다</p>
                        <p class="text-sm">첫 번째 댓글을 작성해보세요!</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <div class="flex justify-between mt-8">
                <a href="/post/list" class="btn btn-outline">
                    <i class="fas fa-arrow-left mr-2"></i>
                    목록으로
                </a>
                <div class="flex gap-2">
                    <button class="btn btn-primary btn-outline">
                        <i class="fas fa-edit mr-2"></i>
                        수정
                    </button>
                    <button class="btn btn-error btn-outline">
                        <i class="fas fa-trash mr-2"></i>
                        삭제
                    </button>
                </div>
            </div>
        </div>

        <!-- Error Message (if post not found) -->
        <div th:if="${post == null}" class="max-w-2xl mx-auto text-center">
            <div class="card bg-base-100 shadow-2xl content-section">
                <div class="card-body p-8">
                    <i class="fas fa-exclamation-triangle text-6xl text-warning mb-4"></i>
                    <h2 class="text-3xl font-bold mb-4">게시글을 찾을 수 없습니다</h2>
                    <p class="text-lg mb-6">요청하신 게시글이 삭제되었거나 존재하지 않습니다.</p>
                    <a href="/post/list" class="btn btn-primary">
                        <i class="fas fa-arrow-left mr-2"></i>
                        게시판으로 돌아가기
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer from fragments -->
    <div th:replace="fragments/footer :: footer"></div>

    <script>
        // 추천 버튼 클릭 시 (추후 구현)
        function likePost() {
            // AJAX로 추천 처리
            console.log('추천 기능 구현 예정');
        }
        
        // 공유 버튼 클릭 시
        function sharePost() {
            if (navigator.share) {
                navigator.share({
                    title: document.title,
                    url: window.location.href
                });
            } else {
                // 브라우저가 Web Share API를 지원하지 않는 경우
                navigator.clipboard.writeText(window.location.href).then(() => {
                    alert('링크가 클립보드에 복사되었습니다!');
                });
            }
        }
    </script>
</body>
</html> 