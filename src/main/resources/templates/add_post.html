<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml" data-theme="light">
<meta charset="UTF-8">
<head>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <title>BookMarket - ê²Œì‹œê¸€ ì‘ì„±</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap');
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .form-section {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }
        .book-fields {
            display: none;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease-in-out;
        }
        .book-fields.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="gradient-bg min-h-screen">
    <!-- Navigation from fragments -->
    <div th:replace="fragments/header :: header"></div>

    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
        <!-- Hero Section -->
        <div class="text-center mb-8">
            <h1 class="text-5xl font-bold text-white mb-4">
                <i class="fas fa-pencil-alt mr-3"></i>
                ê²Œì‹œê¸€ ì‘ì„±
            </h1>
            <p class="text-xl text-white/80">ì—¬ëŸ¬ë¶„ì˜ ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”!</p>
        </div>

        <!-- Post Form -->
        <div class="max-w-4xl mx-auto">
            <div class="card bg-base-100 shadow-2xl form-section">
                <div class="card-body p-8">
                    <form th:action="@{/post/add}" method="post" class="space-y-6" id="postForm">
                        
                        <!-- ê¸°ë³¸ ì •ë³´ ì„¹ì…˜ -->
                        <div class="bg-base-200/50 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-4 flex items-center">
                                <i class="fas fa-info-circle mr-2 text-primary"></i>
                                ê¸°ë³¸ ì •ë³´
                            </h3>
                            
                            <!-- ì¹´í…Œê³ ë¦¬ ì„ íƒ -->
                            <div class="form-control mb-4">
                                <label class="label">
                                    <span class="label-text text-lg font-semibold flex items-center">
                                        <i class="fas fa-tags mr-2 text-primary"></i>
                                        ì¹´í…Œê³ ë¦¬ <span class="text-red-500 ml-1">*</span>
                                    </span>
                                </label>
                                <select name="category" id="category" class="select select-bordered" required onchange="handleCategoryChange()">
                                    <option value="">ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                                    <option value="REVIEW">ğŸ“– ë„ì„œ ë¦¬ë·°</option>
                                    <option value="DISCUSSION">ğŸ’¬ ë…ì„œ í† ë¡ </option>
                                    <option value="RECOMMENDATION">ğŸ‘ ì±… ì¶”ì²œ</option>
                                    <option value="QUESTION">â“ ë…ì„œ ì§ˆë¬¸</option>
                                    <option value="CHAT">ğŸ’­ ììœ  ì¡ë‹´</option>
                                    <option value="NEWS">ğŸ“° ë„ì„œ ì†Œì‹</option>
                                    <option value="CHALLENGE">ğŸ† ë…ì„œ ì±Œë¦°ì§€</option>
                                    <option value="QUOTE">ğŸ“ ì¢‹ì€ êµ¬ì ˆ</option>
                                </select>
                            </div>

                            <!-- ì œëª© -->
                            <div class="form-control mb-4">
                                <label class="label">
                                    <span class="label-text text-lg font-semibold flex items-center">
                                        <i class="fas fa-heading mr-2 text-primary"></i>
                                        ì œëª© <span class="text-red-500 ml-1">*</span>
                                    </span>
                                </label>
                                <input type="text" name="title" class="input input-bordered" 
                                       placeholder="ê²Œì‹œê¸€ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                            </div>

                            <!-- ë‚´ìš© -->
                            <div class="form-control">
                                <label class="label">
                                    <span class="label-text text-lg font-semibold flex items-center">
                                        <i class="fas fa-align-left mr-2 text-primary"></i>
                                        ë‚´ìš© <span class="text-red-500 ml-1">*</span>
                                    </span>
                                </label>
                                <textarea name="content" class="textarea textarea-bordered h-32" 
                                          placeholder="ê²Œì‹œê¸€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”" required></textarea>
                            </div>
                        </div>

                        <!-- ì±… ê´€ë ¨ ì •ë³´ ì„¹ì…˜ (ë™ì  í‘œì‹œ) -->
                        <div id="bookFields" class="book-fields bg-blue-50 p-6 rounded-lg">
                            <h3 class="text-xl font-bold mb-4 flex items-center">
                                <i class="fas fa-book mr-2 text-blue-600"></i>
                                ì±… ì •ë³´
                            </h3>
                            
                            <div class="grid md:grid-cols-2 gap-4">
                                <!-- ì±… ì œëª© -->
                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-semibold flex items-center">
                                            <i class="fas fa-book-open mr-2 text-blue-600"></i>
                                            ì±… ì œëª©
                                        </span>
                                    </label>
                                    <input type="text" name="bookTitle" class="input input-bordered" 
                                           placeholder="ì±… ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                                </div>

                                <!-- ì €ì -->
                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-semibold flex items-center">
                                            <i class="fas fa-user-edit mr-2 text-blue-600"></i>
                                            ì €ì
                                        </span>
                                    </label>
                                    <input type="text" name="author" class="input input-bordered" 
                                           placeholder="ì €ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”">
                                </div>

                                <!-- ì¥ë¥´ -->
                                <div class="form-control">
                                    <label class="label">
                                        <span class="label-text font-semibold flex items-center">
                                            <i class="fas fa-list mr-2 text-blue-600"></i>
                                            ì¥ë¥´
                                        </span>
                                    </label>
                                    <select name="genre" class="select select-bordered">
                                        <option value="">ì¥ë¥´ ì„ íƒ (ì„ íƒì‚¬í•­)</option>
                                        <option value="FICTION">ì†Œì„¤</option>
                                        <option value="NON_FICTION">ë¹„ì†Œì„¤</option>
                                        <option value="MYSTERY">ì¶”ë¦¬/ë¯¸ìŠ¤í„°ë¦¬</option>
                                        <option value="THRILLER">ìŠ¤ë¦´ëŸ¬</option>
                                        <option value="SF">SF/íŒíƒ€ì§€</option>
                                        <option value="ROMANCE">ë¡œë§¨ìŠ¤</option>
                                        <option value="HISTORICAL">ì—­ì‚¬ì†Œì„¤</option>
                                        <option value="BIOGRAPHY">ì „ê¸°/ìì„œì „</option>
                                        <option value="SELF_HELP">ìê¸°ê³„ë°œ</option>
                                        <option value="BUSINESS">ê²½ì˜/ê²½ì œ</option>
                                        <option value="SCIENCE">ê³¼í•™</option>
                                        <option value="PHILOSOPHY">ì² í•™</option>
                                        <option value="PSYCHOLOGY">ì‹¬ë¦¬í•™</option>
                                        <option value="HISTORY">ì—­ì‚¬</option>
                                        <option value="TRAVEL">ì—¬í–‰</option>
                                        <option value="COOKING">ìš”ë¦¬</option>
                                        <option value="ART">ì˜ˆìˆ </option>
                                        <option value="POETRY">ì‹œ/ì—ì„¸ì´</option>
                                        <option value="CHILDREN">ì•„ë™/ì²­ì†Œë…„</option>
                                        <option value="COMIC">ë§Œí™”/ê·¸ë˜í”½ë…¸ë¸”</option>
                                        <option value="RELIGION">ì¢…êµ/ì˜ì„±</option>
                                        <option value="HEALTH">ê±´ê°•/ì˜í•™</option>
                                        <option value="EDUCATION">êµìœ¡/í•™ìŠµ</option>
                                        <option value="OTHER">ê¸°íƒ€</option>
                                    </select>
                                </div>

                                <!-- ìŠ¤í¬ì¼ëŸ¬ ì£¼ì˜ -->
                                <div class="form-control" id="spoilerField">
                                    <label class="label">
                                        <span class="label-text font-semibold flex items-center">
                                            <i class="fas fa-exclamation-triangle mr-2 text-yellow-600"></i>
                                            ìŠ¤í¬ì¼ëŸ¬ ì£¼ì˜
                                        </span>
                                    </label>
                                    <label class="label cursor-pointer justify-start">
                                        <input type="checkbox" name="spoilerAlert" value="true" class="checkbox checkbox-warning mr-2">
                                        <span class="label-text">ì´ ê¸€ì—ëŠ” ìŠ¤í¬ì¼ëŸ¬ê°€ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤</span>
                                    </label>
                                </div>
                            </div>

                            <!-- ë³„ì  (ë¦¬ë·°ì¼ ë•Œë§Œ) -->
                            <div class="form-control mt-4" id="ratingField">
                                <label class="label">
                                    <span class="label-text font-semibold flex items-center">
                                        <i class="fas fa-star mr-2 text-yellow-500"></i>
                                        ë³„ì  í‰ê°€
                                    </span>
                                </label>
                                <div class="rating rating-lg">
                                    <input type="radio" name="rating" value="1" class="mask mask-star-2 bg-yellow-500" />
                                    <input type="radio" name="rating" value="2" class="mask mask-star-2 bg-yellow-500" />
                                    <input type="radio" name="rating" value="3" class="mask mask-star-2 bg-yellow-500" />
                                    <input type="radio" name="rating" value="4" class="mask mask-star-2 bg-yellow-500" />
                                    <input type="radio" name="rating" value="5" class="mask mask-star-2 bg-yellow-500" />
                                </div>
                                <label class="label">
                                    <span class="label-text-alt">ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš” (1ì -5ì )</span>
                                </label>
                            </div>
                        </div>

                        <!-- ì‘ì„± ì™„ë£Œ ë²„íŠ¼ -->
                        <div class="flex flex-col sm:flex-row gap-4 mt-8">
                            <button type="submit" class="btn btn-primary btn-lg flex-1 text-white bg-gradient-to-r from-purple-600 to-blue-600 border-none hover:shadow-lg transform hover:scale-105 transition-all duration-200">
                                <i class="fas fa-pencil-alt mr-2"></i>
                                ê²Œì‹œê¸€ ì‘ì„± ì™„ë£Œ
                            </button>
                            <a href="/post/list" class="btn btn-outline btn-lg flex-1 hover:bg-gradient-to-r hover:from-purple-600 hover:to-blue-600 hover:text-white hover:border-transparent transform hover:scale-105 transition-all duration-200">
                                <i class="fas fa-times mr-2"></i>
                                ì·¨ì†Œ
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- ì‘ì„± ê°€ì´ë“œ -->
        <div class="max-w-4xl mx-auto mt-8">
            <div class="alert alert-info shadow-lg">
                <div>
                    <i class="fas fa-lightbulb text-2xl"></i>
                    <div>
                        <h3 class="font-bold">ê²Œì‹œê¸€ ì‘ì„± íŒ!</h3>
                        <div class="text-xs">
                            â€¢ ğŸ“– ë¦¬ë·°/í† ë¡ : ì±… ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ ë” í’ë¶€í•œ ì •ë³´ ì œê³µ<br>
                            â€¢ âš ï¸ ìŠ¤í¬ì¼ëŸ¬ ì£¼ì˜: ë‚´ìš© ëˆ„ì„¤ì´ ìˆë‹¤ë©´ ê¼­ ì²´í¬í•´ì£¼ì„¸ìš”<br>
                            â€¢ â­ ë³„ì : ë¦¬ë·° ì‘ì„± ì‹œ ì†”ì§í•œ í‰ê°€ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer from fragments -->
    <div th:replace="fragments/footer :: footer"></div>

    <script>
        // ì¹´í…Œê³ ë¦¬ ë³€ê²½ ì‹œ ë™ì  í•„ë“œ í‘œì‹œ/ìˆ¨ê¹€
        function handleCategoryChange() {
            const category = document.getElementById('category').value;
            const bookFields = document.getElementById('bookFields');
            const ratingField = document.getElementById('ratingField');
            const spoilerField = document.getElementById('spoilerField');
            
            // ì±… ê´€ë ¨ ì¹´í…Œê³ ë¦¬ë“¤
            const bookRelatedCategories = ['REVIEW', 'DISCUSSION', 'RECOMMENDATION', 'QUOTE'];
            const reviewCategory = 'REVIEW';
            const spoilerCategories = ['REVIEW', 'DISCUSSION'];
            
            if (bookRelatedCategories.includes(category)) {
                // ì±… ê´€ë ¨ í•„ë“œë“¤ í‘œì‹œ
                bookFields.classList.add('show');
                
                // ë¦¬ë·°ì¼ ë•Œë§Œ ë³„ì  í‘œì‹œ
                if (category === reviewCategory) {
                    ratingField.style.display = 'block';
                } else {
                    ratingField.style.display = 'none';
                    // ë³„ì  ì´ˆê¸°í™”
                    document.querySelectorAll('input[name="rating"]').forEach(radio => {
                        radio.checked = false;
                    });
                }
                
                // ìŠ¤í¬ì¼ëŸ¬ ì£¼ì˜ëŠ” ë¦¬ë·°/í† ë¡ ì¼ ë•Œë§Œ
                if (spoilerCategories.includes(category)) {
                    spoilerField.style.display = 'block';
                } else {
                    spoilerField.style.display = 'none';
                    document.querySelector('input[name="spoilerAlert"]').checked = false;
                }
                
            } else {
                // ì±… ê´€ë ¨ í•„ë“œë“¤ ìˆ¨ê¹€
                bookFields.classList.remove('show');
                
                // ëª¨ë“  ì±… ê´€ë ¨ ì…ë ¥ê°’ ì´ˆê¸°í™”
                document.querySelector('input[name="bookTitle"]').value = '';
                document.querySelector('input[name="author"]').value = '';
                document.querySelector('select[name="genre"]').value = '';
                document.querySelector('input[name="spoilerAlert"]').checked = false;
                document.querySelectorAll('input[name="rating"]').forEach(radio => {
                    radio.checked = false;
                });
            }
        }
        
        // í¼ ì œì¶œ ì „ ìœ íš¨ì„± ê²€ì‚¬
        document.getElementById('postForm').addEventListener('submit', function(e) {
            const category = document.getElementById('category').value;
            const title = document.querySelector('input[name="title"]').value.trim();
            const content = document.querySelector('textarea[name="content"]').value.trim();
            
            if (!category) {
                alert('ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
                e.preventDefault();
                return;
            }
            
            if (!title) {
                alert('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                e.preventDefault();
                return;
            }
            
            if (!content) {
                alert('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                e.preventDefault();
                return;
            }
            
            // ë¦¬ë·° ì¹´í…Œê³ ë¦¬ì¼ ë•Œ ë³„ì  í•„ìˆ˜
            if (category === 'REVIEW') {
                const rating = document.querySelector('input[name="rating"]:checked');
                if (!rating) {
                    alert('ë¦¬ë·° ì‘ì„± ì‹œ ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                    e.preventDefault();
                    return;
                }
            }
        });
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìƒíƒœ ì„¤ì •
        document.addEventListener('DOMContentLoaded', function() {
            handleCategoryChange();
        });
    </script>
</body>
</html>